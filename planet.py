import math
import numpy as np
import matplotlib.pyplot as plt
import tkinter as tk
import tkinter.ttk as ttk
from threading import (Event,Thread)
import time

def COMPACT(Y:float,X:float):
    Y=X*(Y/X-math.floor(Y/X))
    if(int(X)==360 and Y<0):
        Y=Y+360.0
    return Y
def TABLE_VALUE(a,b,c,d,d_b,d_c):
    ac=a+(c-a)*(d_c/10.0)
    bd=b+(d-b)*(d_c/10.0)
    acbd=ac+(bd-ac)*(d_b/10.0)
    return acbd
def DIGIT2(x):
    flag=0
    if(x<0):
        x=-x
        flag=1
    x=float(int((x*100.0)+0.5))
    x=x/100.0
    if(flag==1):
        x=-x
    return x
def DIGIT3(x):
    flag=0
    if(x<0):
        x=-x
        flag=1
    x=float(int(x*1000.0+0.5))
    x=x/1000.0
    if(flag==1):
        x=-x
    return x
def C_1900(JD):
    JD0=2415021.0
    C=(JD-JD0)/((100.0)*365.25)
    return C
def OBL(JD):
    C=C_1900(JD)
    OBL=23.4523-0.013*C-0.00000016388*C*C
    return OBL
def jd(YEAR,MONTH,DAY,HOUR,LST,LON):
    FLAG=1
    if(LON<0):
        LON=-LON
        FLAG=-1
    if(MONTH<3):
        YEAR=YEAR-1
        MONTH=MONTH+12
    S=math.floor(365.25*YEAR)+math.floor(30.59*(MONTH-2.0))
    if(LST==1):
        JUDAY=S+DAY+HOUR/24.0-FLAG*math.floor(LON/15.0+0.5)/24.0+1721086.5
    else:
        JUDAY=S+DAY+HOUR/24.0-FLAG*LON/15.0/24.0+1721086.5
    if(JUDAY>2299150):
        A=math.floor(YEAR/400)-math.floor(YEAR/100)+2
        JUDAY=JUDAY+A
    return JUDAY
def SOLAR_GEO(JD,YEAR0,X,Y,Z):
    JD0=JD(YEAR0,1,1,12,0,0)

    T=(JD0-2451545.0)/36525.0
    t=-(JD-JD0)/36525.0

    Zeta1= 2306.2181 + 1.39656*T - 0.000139*T*T
    Zeta2= 0.30188 - 0.000344*T
    Zeta3= 0.017998
    Theta1 = 2004.3109 - 0.85330*T - 0.000217*T*T
    Theta2 = - ( 0.42665 + 0.000217*T)
    Theta3 = - 0.041833
    Zed1   = 2306.2181 + 1.39656*T - 0.000139*T*T
    Zed2   = 1.09468 + 0.000066*T
    Zed3   = 0.018203

    Zeta  = (  Zeta1*t +  Zeta2*t*t + Zeta3*t*t*t )/3600.0
    Zed   = (   Zed1*t +   Zed2*t*t +  Zed3*t*t*t )/3600.0
    Theta = ( Theta1*t + Theta2*t*t +Theta3*t*t*t )/3600.0
    cosTheta  = math.cos(Theta*P)
    sinTheta  = math.sin(Theta*P)
    cosZed   = math.cos(Zed*P)
    sinZed   = math.sin(Zed*P)
    cosZeta = math.cos(Zeta*P)
    sinZeta = math.sin(Zeta*P)

    Xx = cosZeta*cosZed*cosTheta - sinZeta*sinZed
    Xy = sinZeta*cosZed + cosZeta*sinZed*cosTheta
    Xz =                  cosZeta*sinTheta
    
    Yx = -cosZeta*sinZed - sinZeta*cosZed*cosTheta
    Yy =  cosZeta*cosZed - sinZeta*sinZed*cosTheta
    Yz =                 - sinZeta*sinTheta
    
    Zx = -cosZed*sinTheta
    Zy = -sinZed*sinTheta
    Zz =         cosTheta

    obl     = OBL(JD)
    cosOBL  = math.cos(obl*P)
    sinOBL  = math.sin(obl*P)

    X0 = SRR * math.cos(SL*P)
    Y0 = SRR * math.sin(SL*P) * cosOBL
    Z0 = SRR * math.sin(SL*P) * sinOBL

    X = Xx*X0 + Yx*Y0 + Zx*Z0
    Y = Xy*X0 + Yy*Y0 + Zy*Z0
    Z = Xz*X0 + Yz*Y0 + Zz*Z0
def DEG2HMS(D):
    FLAG=0
    if(D<0):
        D=-D
        FLAG=1
    D=D/15.0
    HOUR=math.floor(D)
    MIN=math.floor((D-HOUR)*60)
    SEC=D*3600-HOUR*3600-MIN*60
    H=HOUR+MIN/100.0+SEC/10000.0
    if(FLAG==1):
        H=-H
    return H
def DEG2DMS(D):
    FLAG=0
    if(D<0):
        D=-D
        FLAG=1
    DEG=math.floor(D)
    MIN=math.floor((D-DEG)*60.0)
    SEC=(D*3600-DEG*3600-MIN*60)
    H=DEG+MIN/100.0+SEC/10000.0
    if(FLAG==1):
        H=-H
    return H
def DMS2DEG(DMS):
    FLAG=0
    if(DMS<0):
        FLAG=1
        DMS=-DMS
    DEG=math.floor(DMS)
    MIN=math.floor((DMS-DEG)*100)
    if(MIN>99.0):
        MIN=MIN-100
        DEG=DEG+1
    SEC=DMS*10000-DEG*10000-MIN*100
    if(SEC>99.0):
        SEC=SEC-100
        MIN=MIN+1
    D=DEG+MIN/60.0+SEC/3600.0
    if(FLAG==1):
        D=-D
    return D
def LSTS(JD,LON):
    GST0=18.6461
    JD0=2415020.0
    R=366.2422/365.2422
    B=JD-JD0
    LST=GST0+24*B*R+3.24E-14*B*B+LON/15.0
    LST=COMPACT(LST,24)
    if(LST<0.0):
        LST=LST+24
    return LST
def AZ_EL(JD,RA,DEC,LAT,LON):
    LST=LSTS(JD,LON)*15.0
    HA=LST-RA
    A=math.sin(HA*P)
    B=math.cos(HA*P)
def ECS2HCS(LST,RA,DEC,LAT):
    phi=LAT
    alpha=RA
    delta=DEC
    a=math.degrees(math.atan((math.cos(math.radians(delta))*math.sin(math.radians(LST-alpha)))/(-math.cos(math.radians(phi))*math.sin(math.radians(delta))+math.sin(math.radians(phi))*math.cos(math.radians(delta))*math.cos(math.radians(LST-alpha)))))
    s=-math.cos(math.radians(phi))*math.sin(math.radians(delta))+math.sin(math.radians(phi))*math.cos(math.radians(delta))*math.cos(math.radians(LST-alpha))
    if s<0:
        a=a+180
    if a<0:
        a=a+360
    h=math.degrees(math.asin(math.cos(math.radians(phi))*math.cos(math.radians(delta))*math.cos(math.radians(LST-alpha))+math.sin(math.radians(phi))*math.sin(math.radians(delta))))
    return a,h
"""
def push_button():
    label=tk.Label(text=var_spinbox1.get())
    label.pack()
def push_button():
    label=tk.Label(text=var_spinbox2.get())
    label.pack()
def push_button():
    label=tk.Label(text=var_spinbox3.get())
    label.pack()
def push_button():
    label=tk.Label(text=var_spinbox4.get())
    label.pack()
def push_button():
    label=tk.Label(text=var_spinbox5.get())
    label.pack()
def push_button():
    label=tk.Label(text=var_spinbox6.get())
    label.pack()
    
main_win=tk.Tk()
main_win.title("60秒以内に入力してね")
main_win.geometry("400x300")

var_spinbox1=tk.StringVar()
var_spinbox1.set(35.0)
spinbox=tk.Spinbox(main_win,from_=0,to=90,increment=0.01,textvariable=var_spinbox1)
spinbox.pack()
button1=tk.Button(text="緯度",command=push_button)
button1.pack()
var_spinbox2=tk.StringVar()
var_spinbox2.set(139.0)
spinbox=tk.Spinbox(main_win,from_=0,to=180,increment=0.01,textvariable=var_spinbox2)
spinbox.pack()
button2=tk.Button(text="経度",command=push_button)
button2.pack()
var_spinbox3=tk.StringVar()
var_spinbox3.set(2023)
spinbox=tk.Spinbox(main_win,from_=0,to=2300,increment=1.0,textvariable=var_spinbox3)
spinbox.pack()
button3=tk.Button(text="年",command=push_button)
button3.pack()
var_spinbox4=tk.StringVar()
var_spinbox4.set(6)
spinbox=tk.Spinbox(main_win,from_=1,to=12,increment=1.0,textvariable=var_spinbox4)
spinbox.pack()
button4=tk.Button(text="月",command=push_button)
button4.pack()
var_spinbox5=tk.StringVar()
var_spinbox5.set(19)
spinbox=tk.Spinbox(main_win,from_=0,to=31,increment=1.0,textvariable=var_spinbox5)
spinbox.pack()
button5=tk.Button(text="日",command=push_button)
button5.pack()
var_spinbox6=tk.StringVar()
var_spinbox6.set(22)
spinbox=tk.Spinbox(main_win,from_=0,to=24,increment=1.0,textvariable=var_spinbox6)
spinbox.pack()
button6=tk.Button(text="時",command=push_button)
button6.pack()
"""
#ユリウス通日を求める
Y=int(input("年"))
M=int(input("月"))
D=int(input("日"))
h=int(input("時"))
LAT=float(input("緯度"))
LON=float(input("経度"))
LON=DMS2DEG(LON)
LAT=DMS2DEG(LAT)
JD=jd(Y,M,D,h,0,LON)
C=C_1900(JD)
LST=LSTS(JD,LON)*15


P=math.pi/180
#太陽の地心位置を求める
#SML:太陽の平均黄経
SML=280.6824+36000.769325*C+7.22222e-4*C*C
SML=COMPACT(SML,360)
#SEC:軌道離心率
SEC=0.0167498-4.258e-5*C-1.373E-7*C*C
#SPL:近日点黄経
SPL=281.2206+1.717697*C+4.83333e-4*C*C+2.77777e-6*C*C*C
SPL=COMPACT(SPL,360)
#SMA:平均近点角
SMA=SML-SPL
#SMPG:太陽の中心差
SMPG=1.91946*math.sin(SMA*P)+2.00939e-2*math.sin(2*SMA*P)-4.78889e-3*math.sin(SMA*P)*C-1.44444e-5*math.sin(SMA*P)*C*C
#SL:真太陽の黄経
SL=SML+SMPG
#SAX:軌道半長径
SAX=1.00000129
#STA:真近点角
STA=SL-SPL
#SRR:動径
SRR=SAX*(1-SEC*SEC)/(1+SEC*math.cos(STA*P))
#SS:視半径
SS=0.2666/SRR
#太陽の座標
SX=SRR*math.cos(SL*P)
SY=SRR*math.sin(SL*P)
SZ=0
BETS=0.0
OBLS=OBL(JD)
RAS=math.atan2((math.cos(OBLS*P)*math.cos(BETS*P)*math.sin(SL*P)-math.sin(OBLS*P)*math.sin(BETS*P)),math.cos(BETS*P)*math.cos(SL*P))/P
if(RAS<0):
    RAS+=360.0
DECS=math.asin(math.cos(OBLS*P)*math.sin(BETS*P)+math.sin(OBLS*P)*math.cos(BETS*P)*math.sin(SL*P))/P
RAS=DEG2HMS(RAS)
DECS=DEG2DMS(DECS)
AZ_EL(JD,RAS,DECS,LAT,LON)
#惑星の座標を求める
#AX:軌道半長径
AX=[
    [  0.38709840,  0.0,  0.0, 0.0],
    [  0.72333015,  0.0,  0.0, 0.0],
    [  0.0       ,  0.0,  0.0, 0.0],
    [  1.52367810,  0.0,  0.0, 0.0],
    [  5.20280500,  0.0,  0.0, 0.0],
    [  9.55474700,  0.0,  0.0, 0.0]
]
#EC:軌道離心率
EC=[
    [  0.20561494,  0.02030e-3  , -0.04e-6  ,  0.0    ],
    [  0.00681636, -0.5384e-4   ,  0.126e-6 ,  0.0    ],
    [  0.0       ,  0.0         ,  0.0      ,  0.0    ],
    [  0.09330880,  0.095284e-3 , -0.122e-6 ,  0.0    ],
    [  0.0483348 ,  0.164180e-3 , -0.4676e-6, -1.7e-9 ],
    [  0.05589231, -0.34550e-3  , -0.728e-6 ,  0.74e-9]
]
#ML:平均黄経
ML=[
    [  182.27175 , 149474.07244 , 2.01944e-3 ,  0.0        ],
    [  344.36936 ,  58519.2126  , 9.8055e-4  ,  0.0        ],
    [    0.0     ,      0.0     , 0.0        ,  0.0        ],
    [  294.26478 ,  19141.69625 , 3.15028e-4 ,  0.0        ],
    [  238.132386,   3036.301986, 3.34683e-4 , -1.64889e-6 ],
    [  266.597875,   1223.50988 , 3.24542e-4 , -5.83333e-7 ]
]
#PNL:近日点黄経
PNL=[
    [    75.89717 , 1.553469 ,  3.08639e-4 ,  0.0       ],
    [   130.14057 , 1.37230  , -1.6472e-3  ,  0.0       ],
    [     0.0     , 0.0      ,  0.0        ,  0.0       ],
    [   334.21833 , 1.840394 ,  3.35917e-4 ,  0.0       ],
    [    12.720972, 1.6099617,  1.05627e-3 , -3.4333e-6 ],
    [    91.09821 , 1.958416 ,  8.26361e-4 ,  4.61111e-6]
]
#OMG:昇交点黄経
OMG=[
    [    47.144736, 1.18476  ,  2.23194e-4  ,  0.0        ],
    [    75.7881  , 0.91403  ,  4.189e-4    ,  0.0        ],
    [     0.0     , 0.0      ,  0.0         ,  0.0        ],
    [    48.78670 , 0.776944 , -6.02778e-4  ,  0.0        ],
    [    99.443414, 1.01053  , +3.52222e-4  , -8.51111e-6 ],
    [   112.790414, 0.873195 , -1.521810e-4 , -5.30555e-6 ]
]
#INC:軌道傾斜角
INC=[
    [  7.003014  ,  1.73833e-3, -1.55555e-5,  0.0 ],
    [  3.3936    ,  1.2522e-3 , -4.333e-6  ,  0.0 ],
    [  0.0       ,  0.0       ,  0.0       ,  0.0 ],
    [  1.85030   , -6.49028e-4,  2.65e-5   ,  0.0 ],
    [  1.308736  , -5.69611e-3,  3.88889e-6,  0.0 ],
    [  2.4925194 , -3.91889e-3, -1.54889e-5, 4.44444e-8]
]

JUP_L8=[
    [-2,-2,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2,-1, 0, 1, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 0, 1,-2],
    [-2,-2,-3,-4,-5,-5,-5,-5,-6,-6,-5,-5,-5,-4,-3,-2,-1, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 1,-2],
    [-2,-2,-3,-4,-5,-5,-6,-6,-7,-7,-7,-7,-7,-6,-5,-5,-4,-3,-2,-1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,-1, 1,-2],
    [-1,-1,-2,-3,-4,-5,-6,-6,-7,-7,-8,-8,-8,-7,-7,-6,-6,-5,-4,-2,-1,-1,-1,-1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,-1, 1,-1],
    [-1,-1,-2,-2,-3,-4,-5,-6,-7,-7,-8,-8,-8,-8,-8,-7,-7,-6,-5,-4,-3,-3,-2,-2,-1,-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1],
    [ 0, 0,-1,-1,-2,-3,-4,-5,-6,-6,-7,-7,-7,-8,-8,-7,-7,-6,-6,-5,-3,-3,-2,-2,-1,-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [ 1, 0, 0, 0,-1,-1,-2,-3,-4,-5,-6,-6,-7,-7,-7,-7,-7,-6,-6,-5,-4,-3,-2,-2,-1,-1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1],
    [ 1, 1, 1, 1, 0, 0,-1,-2,-2,-4,-5,-5,-6,-6,-7,-6,-6,-6,-6,-5,-4,-3,-2,-2,-1,-1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    [ 2, 2, 2, 2, 1, 1, 0, 0,-1,-2,-3,-4,-5,-5,-6,-6,-6,-6,-6,-5,-4,-4,-3,-2,-1,-1, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2],
    [ 2, 2, 2, 2, 2, 1, 1, 0, 0,-1,-2,-3,-4,-4,-5,-5,-6,-6,-6,-5,-4,-4,-3,-2,-1,-1, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2],
    [ 3, 3, 3, 3, 3, 2, 2, 1, 1, 0,-1,-1,-2,-3,-4,-4,-5,-5,-5,-5,-4,-4,-3,-3,-2,-1, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3],
    [ 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 0, 0,-1,-2,-2,-3,-4,-4,-5,-5,-4,-4,-3,-3,-2,-1, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3],
    [ 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 1, 0, 0, 0,-1,-2,-3,-3,-4,-4,-4,-4,-3,-3,-2,-2,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 3],
    [ 2, 2, 3, 3, 3, 3, 3, 3, 3, 2, 2, 1, 1, 0, 0,-1,-2,-3,-4,-4,-4,-4,-3,-3,-2,-2,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 2],
    [ 2, 2, 3, 3, 3, 3, 4, 4, 4, 3, 3, 2, 2, 1, 0,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1,-1, 0, 0, 1, 1, 2, 2, 2],
    [ 1, 1, 2, 2, 3, 3, 4, 4, 4, 3, 3, 2, 2, 1, 1, 0,-1,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1,-1, 0, 0, 1, 1, 2, 2, 1],
    [ 1, 1, 2, 2, 3, 3, 3, 4, 4, 3, 3, 2, 2, 1, 1, 0, 0,-1,-2,-2,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 1],
    [ 1, 1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 3, 2, 2, 1, 0, 0,-1,-2,-2,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 1],
    [ 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 3, 3, 2, 2, 2, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1,-1, 0, 0, 1],
    [ 0, 0, 0, 1, 1, 2, 2, 2, 2, 3, 3, 3, 2, 2, 2, 1, 0, 0, 0,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1,-1, 0, 0, 0],
    [ 0, 0, 0, 0, 1, 1, 2, 2, 2, 2, 3, 2, 2, 2, 2, 1, 1, 0, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0],
    [ 0, 0, 0, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0],
    [-1, 0, 0, 0, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 0, 0,-1,-1,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1],
    [-1,-1, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1],
    [-2,-1,-1,-1, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-2,-2,-2],
    [-2,-1,-1,-1, 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-2,-2,-2],
    [-2,-1,-1,-1, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2],
    [-1,-1,-1, 0, 0, 0, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0,-1,-1,-1,-1,-2,-2,-2,-2,-1],
    [-1,-1,-1, 0, 0, 0, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 1, 1, 0, 0, 0, 0,-1,-1,-1,-1,-1],
    [ 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 0, 0,-1,-1,-1,-1, 0],
    [ 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 1, 1, 0, 0, 0, 0, 0],
    [ 0, 0, 0, 0, 1, 1, 1, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 1, 1, 1, 0, 0],
    [ 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 2, 2, 1, 1, 0],
    [ 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 5, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 2, 2, 1, 1, 0],
    [ 0, 0,-1,-1,-1, 0, 0, 0, 0, 1, 2, 2, 3, 3, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 2, 2, 1, 1, 0],
    [-1,-1,-2,-2,-2,-2,-2,-2,-2,-1, 0, 0, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 1, 0,-1],
    [-2,-2,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-1,-1, 0, 1, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 0,-1,-2]   
]
JUP_PS8=[
    [ 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 3, 2, 2, 1, 0,-1,-1,-2,-2,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2,-1, 0],
    [-1,-1, 0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 2, 2, 2, 1, 0, 0,-1,-1,-2,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1],
    [-2,-2,-1, 0, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 1, 1, 0, 0,-1,-2,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2],
    [-2,-2,-1,-1, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 1, 0,-1,-1,-2,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2],
    [-3,-3,-2,-2,-1,-1, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 3, 3, 2, 1, 0, 0,-1,-2,-3,-3,-4,-4,-4,-4,-3,-3,-3],
    [-3,-3,-2,-2,-1,-1,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 2, 1, 0,-1,-2,-3,-3,-4,-4,-4,-4,-3,-3,-3],
    [-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 2, 3, 4, 4, 4, 4, 5, 5, 4, 3, 2, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4,-4,-3],
    [-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 2, 3, 4, 4, 4, 4, 5, 5, 4, 3, 2, 2, 1, 0,-1,-2,-3,-3,-4,-4,-4,-4,-3],
    [-4,-4,-3,-3,-2,-2,-2,-2,-1,-1,-1, 0, 0, 1, 2, 2, 3, 3, 4, 4, 5, 5, 4, 4, 3, 3, 2, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4],
    [-4,-4,-3,-3,-2,-2,-2,-2,-1,-1,-1,-1, 0, 0, 1, 2, 3, 3, 4, 4, 5, 5, 4, 4, 3, 3, 2, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4],
    [-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1,-1, 0, 0, 1, 2, 2, 3, 3, 4, 4, 5, 5, 4, 4, 3, 2, 1, 0,-1,-1,-2,-2,-3,-3,-3],
    [-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1,-1,-1, 0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 3, 2, 1, 1, 0,-1,-2,-2,-3,-3,-3],
    [-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 4, 3, 2, 2, 1, 0,-1,-1,-2,-2,-3],
    [-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1, 0, 1, 2, 2, 2, 3, 4, 4, 5, 5, 4, 4, 3, 2, 1, 0,-1,-1,-2,-2,-3],
    [-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-1, 0, 1, 1, 2, 3, 4, 4, 5, 5, 5, 5, 4, 3, 2, 1, 0, 0,-1,-2,-3],
    [-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-1, 0, 1, 1, 2, 3, 4, 4, 5, 5, 5, 4, 4, 3, 2, 1, 0, 0,-1,-2,-3],
    [-2,-2,-2,-2,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1, 0, 0, 1, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 2, 1, 1, 0,-1,-2],
    [-2,-2,-2,-2,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 3, 3, 2, 1, 0,-1,-2],
    [-1,-1,-2,-2,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1, 0, 0, 1, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 2, 1, 0,-1],
    [ 0,-1,-2,-2,-3,-3,-3,-3,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1, 0, 1, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 2, 1, 1, 0],
    [ 1, 0,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-3,-3,-2,-2,-2,-2,-1,-1, 0, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 2, 1],
    [ 1, 0,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-3,-3,-2,-2,-2,-2,-2,-1, 0, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 2, 1],
    [ 2, 1, 0, 0,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-3,-3,-3,-3,-2,-2,-2,-2,-1, 0, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 3, 3, 2],
    [ 2, 2, 1, 0,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-3,-3,-3,-3,-2,-2,-2,-2,-1,-1, 0, 1, 2, 2, 3, 3, 4, 4, 4, 4, 3, 3, 2],
    [ 3, 3, 2, 1, 0, 0,-1,-1,-2,-2,-2,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1, 0, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 3],
    [ 3, 3, 2, 2, 1, 0,-1,-1,-2,-2,-2,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1, 0, 1, 1, 2, 3, 4, 4, 4, 4, 4, 4, 3],
    [ 4, 4, 3, 3, 2, 1, 0, 0,-1,-1,-2,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-1, 0, 0, 1, 2, 3, 3, 4, 4, 5, 5, 4],
    [ 4, 4, 3, 3, 2, 1, 0, 0,-1,-1,-2,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1, 0, 1, 2, 3, 3, 4, 4, 5, 5, 4],
    [ 5, 5, 4, 4, 3, 2, 1, 1, 0, 0,-1,-1,-2,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-1, 0, 1, 2, 2, 3, 3, 4, 4, 5],
    [ 5, 5, 4, 4, 3, 2, 1, 1, 0, 0,-1,-1,-2,-2,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-1, 0, 0, 1, 2, 3, 3, 4, 4, 5],
    [ 4, 4, 5, 5, 4, 3, 2, 2, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-1,-1, 0, 1, 2, 3, 4, 4, 4],
    [ 4, 4, 5, 5, 4, 4, 3, 2, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-1,-1,-1, 0, 1, 2, 3, 3, 4],
    [ 3, 3, 4, 4, 4, 4, 4, 3, 2, 2, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-2,-1, 0, 1, 2, 2, 3],
    [ 2, 3, 4, 4, 4, 4, 4, 4, 3, 3, 2, 2, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-2,-2,-1, 0, 1, 1, 2],
    [ 1, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 3, 2, 2, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-4,-4,-4,-4,-3,-3,-3,-3,-2,-1, 0, 0, 1],
    [ 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 1, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4,-4,-3,-3,-3,-3,-2,-2,-1, 0, 1],
    [ 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 3, 2, 2, 1, 0,-1,-1,-2,-2,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2,-1, 0]
]
JUP_PH8=[
    [ 4, 4, 4, 3, 3, 2, 2, 1, 1, 0, 0,-1,-2,-2,-3,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1, 0, 1, 2, 2, 3, 3, 4, 4, 4],
    [ 4, 4, 4, 3, 3, 2, 2, 2, 2, 1, 1, 0, 0,-1,-2,-2,-3,-3,-3,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1, 0, 1, 1, 2, 2, 3, 3, 4],
    [ 3, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 1, 1, 0, 0,-1,-2,-2,-3,-3,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1, 0, 1, 1, 2, 3, 3, 3],
    [ 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 1, 1, 1, 0,-1,-1,-2,-3,-3,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1, 0, 1, 1, 2, 2, 3],
    [ 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 0, 0,-1,-2,-3,-3,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1, 0, 1, 1, 2, 2],
    [ 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4,-3,-3,-2,-2,-1,-1, 0, 1, 1, 2],
    [ 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 1, 1, 0,-1,-2,-3,-3,-4,-4,-5,-4,-4,-3,-3,-2,-2,-1, 0, 1, 1],
    [ 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 2, 2, 1, 0,-1,-1,-2,-3,-4,-4,-5,-4,-4,-3,-3,-2,-2,-1,-1, 0, 1],
    [ 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 3, 3, 2, 2, 1, 0,-1,-2,-3,-4,-4,-5,-5,-5,-4,-4,-3,-3,-2,-1,-1, 0],
    [ 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 4, 3, 3, 3, 3, 2, 2, 1, 0,-1,-2,-3,-3,-4,-4,-5,-5,-4,-4,-3,-3,-2,-1, 0],
    [-1, 0, 0, 0, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 3, 3, 3, 2, 1, 0,-1,-2,-3,-4,-4,-5,-5,-5,-4,-4,-3,-3,-2,-1],
    [-1,-1, 0, 0, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 3, 3, 3, 2, 2, 1, 0,-1,-2,-3,-3,-4,-4,-5,-5,-4,-4,-3,-2,-1],
    [-2,-1, 0, 0, 0, 0, 1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 3, 2, 1, 0, 0,-1,-2,-3,-4,-4,-5,-5,-4,-4,-3,-3,-2],
    [-2,-2,-1, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 3, 3, 2, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4,-4,-3,-3,-2],
    [-3,-3,-2,-1, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 4, 4, 4, 3, 3, 2, 1, 0,-1,-2,-3,-3,-4,-4,-4,-4,-4,-3,-3],
    [-3,-3,-2,-1,-1,-1, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 3, 3, 4, 4, 4, 4, 3, 2, 1, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4,-4,-3],
    [-4,-3,-2,-2,-1,-1, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 1, 0,-1,-2,-2,-3,-3,-4,-4,-4,-4,-4],
    [-4,-3,-3,-2,-2,-1,-1,-1,-1, 0, 0, 0, 0, 1, 1, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 2, 1, 0,-1,-1,-2,-2,-3,-3,-4,-4,-4],
    [-4,-3,-3,-2,-2,-1,-1,-1,-1,-1, 0, 0, 0, 1, 1, 2, 3, 3, 4, 4, 5, 5, 4, 4, 3, 2, 1, 0,-1,-1,-2,-2,-3,-3,-4,-4,-4],
    [-4,-3,-3,-3,-3,-2,-1,-1,-1,-1, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 3, 3, 2, 1, 0, 0,-1,-1,-2,-3,-4,-4,-4],
    [-4,-4,-4,-3,-3,-3,-2,-2,-1,-1, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 3, 3, 2, 2, 1, 0,-1,-2,-3,-4,-4,-4],
    [-4,-4,-4,-4,-3,-3,-2,-2,-2,-1,-1, 0, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 3, 3, 3, 3, 2, 1, 0,-1,-2,-3,-3,-4],
    [-4,-4,-4,-4,-4,-3,-3,-2,-2,-1,-1, 0, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 3, 2, 1, 0,-1,-2,-3,-3,-4],
    [-3,-3,-4,-4,-4,-3,-3,-3,-3,-2,-2,-1,-1,-1, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 1, 0,-1,-2,-3,-3],
    [-3,-3,-4,-4,-4,-4,-4,-3,-3,-2,-2,-2,-1,-1, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 3, 2, 1, 0,-1,-2,-3],
    [-2,-2,-3,-3,-4,-4,-4,-4,-3,-2,-2,-2,-1,-1,-1, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 4, 4, 3, 2, 1, 1, 0,-1,-2],
    [-2,-2,-3,-3,-4,-4,-4,-4,-3,-2,-2,-2,-2,-1,-1,-1,-1, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 1, 0,-1,-2],
    [-1,-1,-2,-3,-4,-4,-4,-4,-4,-3,-3,-3,-2,-2,-2,-1,-1, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 4, 3, 2, 1, 0,-1],
    [ 0,-1,-2,-3,-4,-4,-4,-4,-4,-3,-3,-3,-2,-2,-2,-1,-1,-1, 0, 0, 0, 1, 2, 2, 3, 3, 4, 4, 5, 5, 4, 4, 4, 3, 2, 1, 0],
    [ 0, 0,-1,-2,-3,-3,-4,-4,-4,-3,-3,-3,-3,-2,-2,-1,-1,-1,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 1, 0],
    [ 1, 0,-1,-1,-2,-2,-3,-3,-4,-4,-4,-3,-3,-2,-2,-2,-2,-1,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 4, 4, 3, 2, 1],
    [ 2, 1, 0,-1,-2,-2,-3,-3,-3,-4,-4,-4,-3,-3,-3,-2,-2,-2,-2,-2,-1, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 2, 2],
    [ 3, 2, 1, 0,-1,-1,-2,-2,-3,-3,-4,-4,-3,-3,-3,-2,-2,-2,-2,-2,-1,-1, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 3, 3],
    [ 3, 2, 2, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1,-1, 0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 4, 4, 3],
    [ 4, 3, 3, 2, 1, 1, 0, 0,-1,-1,-2,-2,-3,-3,-3,-3,-3,-3,-3,-3,-3,-3,-2,-2,-1,-1, 0, 1, 2, 2, 3, 3, 4, 4, 5, 4, 4],
    [ 4, 3, 3, 3, 2, 2, 1, 1, 0, 0,-1,-2,-2,-3,-3,-3,-3,-3,-4,-4,-3,-3,-3,-3,-2,-2,-1, 0, 1, 1, 2, 2, 3, 3, 4, 4, 4],
    [ 4, 4, 4, 3, 3, 2, 2, 2, 0, 0, 0,-1,-2,-2,-3,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-2,-2,-1, 0, 1, 2, 2, 3, 3, 4, 4, 4]
]
SAT_L8=[
    [55,57,58,59,60,60,61,61,61,59,57,56,54,52,49,47,45,43,42,42,41,40,40,40,41,41,42,43,44,45,46,47,47,50,52,53,55],
    [58,60,61,63,65,66,67,67,67,66,65,64,62,60,57,55,53,51,49,48,47,46,46,45,46,46,47,48,49,50,51,51,51,53,55,56,58],
    [60,61,63,65,67,68,70,71,71,71,71,70,69,67,65,63,61,59,56,55,53,52,52,51,51,51,52,52,53,53,54,54,54,56,57,58,60],
    [60,61,63,64,66,68,70,71,72,73,74,74,74,73,71,70,68,66,63,61,59,58,57,56,56,56,56,56,56,56,56,57,57,57,58,59,60],
    [59,60,62,63,65,67,69,71,73,74,75,75,76,75,75,74,72,70,68,66,64,63,61,60,59,59,58,58,58,58,58,58,58,58,58,59,59],
    [59,60,61,62,63,65,67,69,71,73,74,75,76,76,76,75,74,72,71,69,67,66,64,63,62,61,60,60,60,59,59,59,59,59,59,59,59],
    [59,60,60,61,62,63,65,67,69,71,73,74,75,76,76,75,75,74,72,71,69,68,66,65,64,63,62,61,61,60,60,59,59,59,59,59,59],
    [58,58,58,58,59,61,63,64,66,68,70,72,73,74,75,75,75,74,73,72,71,70,68,67,65,64,63,62,61,61,61,60,60,59,58,58,58],
    [56,56,56,56,57,58,60,61,63,65,67,69,71,72,74,75,75,74,74,73,72,71,69,68,66,65,64,63,62,61,61,60,60,59,58,57,56],
    [55,55,54,54,55,56,58,59,61,63,65,67,69,70,72,73,74,74,74,73,72,71,69,68,66,65,64,63,62,61,60,59,59,58,57,56,55],
    [54,54,53,53,53,54,55,56,58,60,62,64,66,68,70,71,72,73,73,73,72,71,70,69,67,66,64,63,62,61,60,59,59,57,56,55,54],
    [53,53,52,52,51,52,53,54,55,57,59,61,63,65,67,69,70,71,71,72,71,70,70,69,67,66,64,63,62,61,59,58,58,56,55,54,53],
    [52,52,51,51,50,50,51,52,53,54,56,58,60,62,64,66,68,69,69,70,70,70,69,68,67,66,64,63,61,60,58,57,57,55,54,53,52],
    [51,51,50,50,49,49,49,50,51,52,54,56,58,60,62,64,66,67,68,68,69,69,68,67,66,65,63,62,61,60,58,57,57,54,53,52,51],
    [50,50,49,49,48,48,48,48,49,50,51,53,55,57,59,61,63,64,66,66,67,67,67,66,65,64,62,61,60,59,57,56,56,53,52,51,50],
    [49,49,48,48,47,47,47,47,48,48,49,50,52,54,56,58,60,61,63,64,65,65,65,64,64,63,61,60,59,58,56,55,55,53,52,51,49],
    [49,48,47,47,46,46,46,46,46,46,47,48,49,51,53,54,56,57,59,61,62,62,62,62,62,61,60,59,58,57,55,54,54,52,51,50,49],
    [48,47,46,46,45,45,45,45,44,44,45,46,47,49,50,51,53,54,56,58,59,60,60,60,60,59,59,58,57,56,54,53,53,51,50,49,48],
    [48,47,46,46,45,45,44,44,43,43,44,44,45,46,47,48,50,51,53,55,56,57,57,58,58,57,57,56,55,54,53,52,52,50,49,48,48],
    [47,46,46,45,44,44,43,43,42,42,42,42,43,43,44,45,47,48,50,51,52,53,54,55,55,55,55,55,54,53,52,51,54,49,48,48,47],
    [47,46,45,45,44,43,42,42,41,41,41,41,41,41,42,43,44,45,47,48,49,50,51,52,52,52,53,53,52,52,51,51,54,49,48,48,47],
    [46,45,45,44,43,42,41,41,40,40,39,39,39,39,40,40,41,42,44,45,46,47,48,49,49,50,51,51,51,50,50,50,50,48,47,47,46],
    [45,45,44,43,42,41,41,40,39,39,38,38,38,38,38,38,39,40,41,42,43,44,45,43,47,48,49,49,49,49,49,48,48,48,47,46,45],
    [44,44,43,42,41,40,39,39,38,38,37,37,36,36,36,36,37,37,38,39,40,41,42,43,44,45,46,47,48,48,47,47,47,47,46,45,44],
    [44,43,42,42,41,40,39,38,37,37,36,36,35,35,35,35,35,35,36,37,38,39,40,41,42,43,44,45,46,46,46,46,46,46,45,44,44],
    [43,42,41,41,40,39,38,37,36,36,35,34,33,33,33,33,33,33,34,34,35,36,37,38,40,41,42,43,44,44,44,45,45,45,45,44,43],
    [43,42,41,40,39,38,37,36,35,35,34,33,32,32,32,32,32,32,32,32,33,34,35,36,38,39,40,41,42,42,43,43,43,44,44,44,43],
    [42,41,40,39,38,37,36,35,34,34,33,32,31,31,31,31,31,31,31,31,32,32,33,34,36,37,38,39,40,40,41,41,41,42,43,43,42],
    [42,41,40,39,38,37,36,35,34,33,32,32,31,31,30,30,30,30,30,30,31,31,32,33,34,35,36,37,38,39,40,40,40,41,42,42,42],
    [41,40,40,39,38,37,36,35,34,33,32,31,30,30,29,29,29,29,29,30,30,30,31,32,33,33,34,35,36,37,38,39,39,40,41,41,41],
    [41,40,40,39,39,38,37,36,34,33,32,31,30,30,29,29,29,29,29,29,29,30,30,31,32,32,33,34,35,36,37,38,38,40,41,41,41],
    [41,41,41,40,40,39,38,37,35,34,33,32,31,30,30,30,29,29,29,29,29,30,30,31,32,32,33,34,35,36,37,38,38,40,41,41,41],
    [42,43,43,42,42,41,40,39,37,36,34,33,32,31,30,30,29,29,29,29,29,30,30,31,32,32,33,34,35,36,37,38,38,40,41,42,42],
    [44,45,46,45,45,44,44,42,40,39,37,36,35,34,32,31,30,30,30,30,30,31,31,32,32,33,34,35,36,37,38,39,39,41,43,44,44],
    [47,48,49,49,49,49,48,47,45,44,42,41,39,38,36,35,34,33,32,32,32,33,33,33,34,34,35,36,37,38,39,40,40,43,45,46,47],
    [51,42,53,54,54,54,54,53,52,50,48,47,45,44,42,40,39,37,36,36,36,36,36,36,37,37,38,39,40,41,42,43,43,46,48,49,51],
    [55,47,58,59,60,60,61,61,61,59,57,56,54,52,49,47,45,43,42,40,41,40,40,40,41,41,42,43,44,45,46,47,47,50,52,53,55]
]
SAT_PS8=[
    [33,34,35,37,39,41,44,47,49,52,54,57,60,62,64,66,67,67,67,67,66,64,62,60,57,54,50,46,43,40,37,35,33,32,32,32,33],
    [32,33,35,38,41,44,47,50,53,56,58,61,63,65,66,67,68,68,67,66,64,62,60,57,54,51,47,44,41,38,35,33,31,30,30,31,32],
    [31,33,36,39,42,46,49,52,56,59,61,64,66,67,68,69,69,68,67,65,63,61,58,55,51,48,45,42,39,36,33,31,30,29,29,30,31],
    [32,34,37,40,43,46,50,53,57,60,63,66,68,69,70,70,70,69,67,65,63,60,56,53,49,46,43,40,37,35,33,31,30,29,29,30,32],
    [33,35,37,40,43,47,50,54,58,61,64,67,69,71,72,72,71,70,68,65,63,59,55,51,48,45,42,39,36,34,32,31,30,30,30,31,33],
    [35,36,38,41,44,47,50,54,58,61,64,67,69,71,72,72,71,70,68,65,62,59,55,51,47,44,41,38,36,34,33,32,32,32,32,33,35],
    [37,38,40,42,45,47,50,54,57,60,63,66,68,70,71,71,71,69,67,64,61,58,54,50,46,43,40,38,36,35,34,34,34,35,35,36,37],
    [39,40,42,44,46,48,51,54,57,60,62,65,67,69,70,70,70,68,66,63,60,57,53,50,46,43,40,38,37,36,35,36,36,37,37,38,39],
    [42,43,45,46,48,49,51,54,56,59,61,63,35,67,68,67,68,67,65,62,59,56,52,49,46,43,41,39,38,38,37,38,38,39,40,41,42],
    [45,46,47,48,49,50,51,53,55,57,59,61,32,64,65,65,65,64,62,60,57,54,51,48,45,43,41,40,39,39,39,40,41,42,43,44,45],
    [49,49,50,50,51,51,52,53,54,56,57,58,59,60,61,62,62,61,59,57,55,52,50,47,45,43,42,41,41,41,41,42,44,45,46,48,49],
    [52,52,53,53,53,53,53,54,54,54,55,56,56,56,57,58,58,57,56,54,52,50,48,46,44,43,42,42,42,42,43,44,46,47,48,50,52],
    [54,54,55,55,55,55,54,54,53,53,53,53,53,53,54,54,54,54,53,51,50,49,47,46,44,43,42,42,42,43,45,46,47,49,50,52,54],
    [56,56,57,57,57,56,55,54,53,52,51,51,50,50,50,50,50,50,50,49,48,48,47,46,45,44,44,44,44,45,47,48,49,51,53,54,56],
    [57,57,58,58,58,57,55,54,53,52,50,49,48,48,47,47,47,47,47,47,47,47,47,47,46,46,46,46,47,48,50,51,52,53,55,56,57],
    [58,58,59,59,59,57,55,54,53,51,49,48,45,45,45,44,44,44,44,45,45,46,47,47,47,47,48,48,49,50,52,53,54,55,56,57,58],
    [59,59,60,60,59,58,56,54,52,50,48,46,44,43,42,42,41,42,42,43,44,45,46,47,48,48,49,50,51,52,53,54,55,56,57,58,59],
    [59,59,60,59,58,57,56,54,52,50,47,45,43,42,40,40,39,40,40,42,43,45,46,47,49,50,51,51,52,53,54,55,56,56,57,58,59],
    [58,58,59,59,58,57,56,54,52,50,47,45,43,41,39,38,38,38,39,41,42,44,46,48,50,51,52,53,54,55,55,56,56,56,57,57,58],
    [57,57,58,58,57,56,55,53,52,50,47,45,43,41,39,38,38,38,39,41,42,44,46,48,50,51,53,54,55,56,56,56,56,56,56,56,57],
    [55,55,56,56,55,54,53,52,51,49,47,45,43,41,39,38,38,38,39,41,43,45,47,49,50,52,54,55,56,56,56,56,56,55,55,55,55],
    [53,53,54,54,53,53,52,51,50,49,48,46,44,42,41,40,39,40,41,42,44,46,48,50,51,53,54,55,56,56,56,56,55,54,54,54,53],
    [51,51,51,51,51,51,50,50,49,49,48,47,45,44,42,43,42,42,43,44,45,47,49,51,53,54,55,56,56,56,56,55,54,53,52,52,51],
    [49,48,48,48,48,48,48,48,48,48,48,47,46,46,45,45,45,45,45,46,47,49,50,52,54,55,56,56,56,56,56,55,53,52,50,50,49],
    [46,45,44,44,45,45,46,46,47,47,48,48,48,48,48,48,48,48,48,49,50,51,52,54,55,55,56,56,56,56,55,54,52,50,45,47,46],
    [43,42,41,41,42,42,43,44,46,47,48,49,50,50,51,51,51,51,51,52,53,53,54,55,56,56,57,56,56,55,54,52,50,48,46,45,43],
    [40,39,38,38,38,39,40,42,44,46,48,50,52,53,54,54,55,55,55,55,56,56,56,57,57,57,57,56,55,54,53,51,49,47,44,42,40],
    [37,36,35,35,35,36,38,40,43,46,48,51,53,55,57,58,59,59,59,59,59,59,58,58,58,57,57,56,55,53,52,50,47,45,42,40,37],
    [35,34,33,33,33,34,36,39,42,45,48,51,54,57,59,61,62,63,63,63,62,61,60,60,59,58,57,56,54,52,50,48,45,43,40,38,35],
    [33,32,31,31,31,32,34,37,41,44,48,52,55,58,61,63,65,66,66,66,65,63,62,61,60,58,57,55,53,51,49,46,44,41,38,36,33],
    [32,30,29,29,29,31,33,36,40,44,48,52,56,60,63,65,67,68,68,68,67,66,64,62,60,58,56,54,52,50,47,44,42,39,37,35,32],
    [31,30,29,29,29,31,33,36,39,43,48,52,57,61,64,67,69,70,70,70,69,68,66,63,61,58,56,53,51,49,46,43,41,38,36,34,31],
    [31,30,29,29,29,31,33,36,39,43,48,53,57,61,65,68,70,71,72,71,70,69,67,64,61,58,55,52,50,47,45,42,40,37,35,33,31],
    [32,31,30,30,30,32,34,37,40,44,49,53,57,61,65,68,70,71,72,71,70,69,67,64,61,58,54,51,48,46,43,41,39,36,35,33,32],
    [32,32,32,32,33,35,37,39,42,45,49,53,57,61,64,67,69,70,71,70,70,68,66,63,60,57,53,50,47,44,41,39,37,35,34,33,32],
    [33,33,34,35,36,38,40,42,45,48,51,55,58,61,64,66,68,69,70,69,68,66,64,62,59,56,52,48,45,42,39,37,35,34,33,33,33],
    [33,34,35,37,39,41,44,46,49,52,54,57,60,62,64,66,67,67,67,67,66,64,62,60,57,54,50,46,43,40,37,35,33,32,32,32,33]
]
SAT_PH8=[
    [54,57,59,61,63,65,66,66,67,67,66,65,63,61,59,57,54,51,47,44,41,38,36,34,33,32,31,32,33,34,36,39,42,45,48,51,54],
    [57,60,62,64,66,67,68,68,67,67,66,64,61,59,56,54,51,48,44,41,38,36,34,33,32,32,31,32,34,35,37,40,44,47,50,53,57],
    [59,62,64,66,68,68,69,69,68,67,65,63,60,57,54,51,48,45,45,39,36,34,33,32,31,31,31,32,34,36,38,41,45,48,52,55,59],
    [60,63,65,67,69,69,70,70,69,67,65,63,60,57,53,50,46,43,40,37,35,32,31,31,30,30,31,33,35,37,39,42,46,50,53,56,60],
    [61,63,65,67,69,69,70,70,69,68,65,63,60,57,53,49,45,41,38,35,33,31,30,30,29,30,31,33,35,38,41,44,47,51,54,57,61],
    [60,62,64,66,68,68,69,69,69,67,65,62,59,56,53,49,45,41,38,35,33,31,30,30,29,30,32,34,36,39,42,45,48,51,54,57,60],
    [59,61,63,65,66,66,67,67,67,66,64,62,59,56,52,49,45,41,38,35,33,31,30,30,30,31,33,35,38,40,43,46,49,52,54,57,59],
    [59,60,62,63,64,64,65,65,65,64,62,60,58,55,52,49,45,42,39,36,34,32,31,31,32,33,35,37,40,43,45,48,51,53,55,57,59],
    [58,59,60,60,61,61,62,62,62,61,60,59,57,54,52,49,46,43,40,37,35,34,33,33,34,36,38,40,43,46,48,50,52,54,56,57,58],
    [57,58,58,58,58,59,59,59,59,58,58,57,55,53,51,49,46,43,41,39,37,36,36,36,37,39,41,43,46,48,50,52,54,55,56,56,57],
    [56,56,56,56,56,56,56,56,56,55,55,54,53,52,50,48,46,44,42,40,39,39,39,39,40,42,44,46,48,50,52,54,55,55,56,56,56],
    [56,55,54,54,53,53,52,52,52,52,52,52,51,50,49,48,47,45,44,43,42,42,42,42,43,44,46,48,50,52,54,55,56,56,56,56,56],
    [55,54,53,52,51,50,49,49,49,49,49,49,49,48,48,47,47,46,46,45,45,45,45,45,46,47,49,50,51,53,55,56,56,56,56,56,55],
    [55,53,52,50,49,48,47,46,46,46,46,47,47,47,47,47,47,47,48,47,48,48,48,48,49,50,52,53,54,55,56,56,57,56,56,56,55],
    [54,52,50,49,47,46,45,44,44,44,44,44,45,45,46,47,48,48,49,49,50,50,51,51,52,53,54,55,56,56,57,57,57,56,56,55,54],
    [54,52,50,48,46,44,43,42,42,42,42,42,43,44,46,47,48,49,51,52,53,53,54,54,55,55,56,56,57,57,57,57,56,56,55,54,54],
    [53,51,49,47,45,43,42,41,40,40,40,41,42,43,45,47,49,50,52,54,55,55,56,56,57,57,57,57,57,57,57,57,56,56,55,54,53],
    [52,50,48,47,45,43,42,41,40,39,39,40,40,42,45,47,49,51,53,55,57,57,58,58,59,59,58,58,57,57,56,56,55,55,54,53,52],
    [51,49,48,46,45,43,41,40,39,39,38,39,39,41,44,46,49,51,54,56,58,59,60,60,60,60,59,58,57,57,56,55,54,54,53,52,51],
    [50,49,47,46,44,42,41,40,40,39,39,40,40,42,45,47,49,52,55,56,58,59,60,60,60,60,59,58,57,56,55,54,53,53,52,51,50],
    [49,48,47,45,44,42,41,41,40,40,40,41,42,44,46,48,50,52,55,57,58,58,59,59,59,59,58,57,56,55,54,53,52,52,51,50,49],
    [48,48,47,46,45,44,43,43,42,42,42,42,43,45,46,48,50,52,55,56,57,58,59,59,59,58,57,56,54,53,52,51,50,50,49,49,48],
    [47,47,47,47,47,46,46,46,45,44,44,44,45,46,47,49,50,52,54,56,57,58,59,59,58,57,55,54,52,51,49,48,47,47,47,47,47],
    [46,47,47,48,48,48,48,48,48,47,47,47,47,48,49,50,51,52,54,55,56,57,57,57,56,55,53,52,50,49,47,46,45,45,45,46,46],
    [45,47,48,49,50,50,51,51,52,51,51,51,50,50,51,51,52,52,53,54,55,55,55,55,54,53,51,50,48,47,45,44,43,43,43,44,45],
    [44,46,48,50,51,52,54,55,56,55,55,55,54,53,53,53,53,53,53,53,53,53,53,52,51,50,49,48,46,45,43,42,41,42,42,43,44],
    [43,46,48,51,53,55,57,58,59,59,59,59,58,57,56,55,54,53,52,52,51,51,50,49,48,47,46,45,43,42,41,41,40,40,41,42,43],
    [43,46,49,52,54,57,60,61,62,63,63,63,62,60,58,57,55,54,52,51,50,49,48,47,46,45,44,43,41,40,39,39,38,38,39,41,43],
    [42,46,49,53,56,59,62,64,66,67,67,67,66,64,61,59,56,54,52,50,48,47,45,44,43,42,41,40,39,38,37,37,36,37,38,40,42],
    [42,46,49,53,57,61,64,66,69,69,70,70,69,66,63,61,58,55,52,49,47,45,43,42,41,40,39,38,37,36,35,35,35,36,38,40,42],
    [42,46,50,54,58,62,65,68,71,72,73,72,71,68,65,62,59,56,52,49,46,43,41,40,38,37,36,35,34,34,33,33,34,36,37,39,42],
    [43,46,50,54,58,62,66,69,71,73,74,73,72,69,66,63,60,56,52,48,45,42,40,38,36,35,34,34,33,33,32,33,34,36,38,40,43],
    [43,47,51,55,59,63,67,70,72,73,74,74,73,70,67,64,60,56,52,48,44,41,39,37,35,34,33,33,32,32,32,33,35,36,38,40,43],
    [44,48,51,55,59,63,66,69,71,72,73,73,72,69,66,63,59,55,51,47,44,41,38,36,34,33,32,32,31,32,33,34,36,37,39,41,44],
    [47,50,53,56,59,63,65,67,69,70,71,70,69,67,65,62,59,55,51,47,43,40,37,35,33,32,31,31,31,32,33,35,37,39,41,43,47],
    [50,53,56,58,61,63,65,66,68,69,69,68,66,64,62,60,57,53,49,46,42,39,37,35,33,32,31,31,32,33,34,37,39,42,44,47,50],
    [54,57,59,61,63,65,66,66,67,67,66,65,63,61,59,57,54,51,47,44,41,38,36,34,33,32,31,32,33,34,36,39,42,45,48,51,54]
]
SAT_AX8=[
    [83,83,83,83,82,81,80,79,78,77,76,76,75,75,75,75,74,74,74,74,74,74,74,74,75,75,76,76,77,78,79,80,82,82,83,83,83],
    [84,84,84,84,83,83,82,81,80,79,78,77,76,76,75,75,74,74,74,73,73,73,73,74,74,74,75,76,77,78,79,80,82,82,83,83,84],
    [84,84,85,84,84,84,83,83,82,81,80,79,78,77,76,75,75,74,74,74,73,73,73,73,74,74,75,76,77,78,79,80,82,82,83,83,84],
    [82,83,83,83,83,83,83,83,83,82,81,80,80,79,78,77,76,75,75,74,73,73,73,73,73,73,74,75,76,77,77,78,80,80,81,82,82],
    [79,80,80,80,81,81,82,82,82,82,81,81,80,79,78,77,76,75,74,73,72,72,71,71,71,71,72,73,73,74,74,75,77,77,78,79,79],
    [74,75,76,76,77,77,78,78,79,79,79,79,78,78,77,76,75,74,73,72,70,70,69,69,68,68,69,69,69,70,70,71,72,72,73,74,74],
    [68,69,70,70,71,72,73,73,74,74,75,75,75,75,74,74,73,72,70,69,68,67,66,66,65,65,64,64,65,65,65,65,66,66,67,68,68],
    [62,63,63,64,65,66,67,67,68,69,70,70,71,71,70,70,70,69,67,66,65,63,62,61,60,60,59,59,59,59,59,59,60,60,61,61,62],
    [55,56,56,57,58,59,60,61,62,63,64,65,66,66,66,66,65,64,63,62,60,59,58,56,55,55,54,54,53,53,53,53,53,53,54,54,55],
    [48,49,49,50,51,52,53,54,56,57,58,59,60,60,61,60,60,59,58,57,55,54,53,51,52,49,48,48,47,47,47,46,46,46,47,47,48],
    [41,42,42,43,44,45,46,47,49,50,52,52,53,53,54,54,54,53,52,51,50,49,47,46,44,43,42,41,40,40,40,40,40,40,40,40,41],
    [35,36,36,37,37,38,39,40,42,43,45,46,46,47,48,48,48,47,46,45,44,43,42,40,38,37,36,35,34,34,34,33,33,33,34,34,35],
    [29,30,30,31,31,32,33,34,35,36,38,39,40,41,42,42,42,42,41,40,38,37,36,35,33,32,30,29,28,28,28,27,27,27,28,28,29],
    [24,25,25,25,26,26,27,28,29,30,32,33,34,35,36,36,36,36,35,35,23,32,31,30,28,27,25,24,23,23,23,22,22,22,23,23,24],
    [20,20,20,20,21,21,22,23,24,25,26,27,27,28,29,30,30,30,30,30,29,28,26,25,24,23,21,21,20,20,19,19,18,18,19,19,20],
    [16,16,17,17,17,17,18,19,20,20,21,21,22,22,23,24,25,25,25,25,25,24,22,21,20,20,19,18,17,17,16,16,15,15,15,15,16],
    [14,14,15,15,15,15,15,16,16,16,17,17,18,18,19,20,20,20,21,21,21,21,20,19,18,18,17,16,15,15,14,14,13,13,13,13,14],
    [13,13,14,14,14,14,13,13,13,13,14,14,15,15,16,17,17,17,18,18,19,19,19,18,17,17,16,16,15,15,14,14,13,13,13,13,13],
    [13,13,13,13,13,13,13,13,12,12,12,12,13,14,14,15,16,16,17,17,18,18,18,18,17,17,16,16,15,15,14,14,13,13,13,13,13],
    [14,14,14,14,14,14,14,14,13,13,12,12,13,14,14,15,16,16,17,17,18,18,19,19,18,18,17,17,16,16,15,15,14,14,14,14,14],
    [16,16,16,16,15,15,15,15,14,14,13,13,14,14,14,15,16,17,18,18,19,19,20,20,21,21,20,20,19,19,18,18,17,17,16,16,16],
    [19,19,19,19,18,18,18,18,17,17,16,16,16,16,16,17,18,19,20,20,21,22,23,23,24,24,24,24,23,23,22,22,21,21,20,19,19],
    [23,23,23,22,22,22,22,22,21,21,20,20,20,20,20,20,21,22,23,24,25,26,27,27,28,28,28,28,27,27,26,26,25,25,24,24,23],
    [28,28,28,27,27,27,27,27,26,26,25,25,25,25,25,25,26,36,27,29,30,30,31,31,32,32,33,33,32,32,31,30,29,29,29,29,28],
    [33,33,33,33,33,33,32,32,32,32,31,31,31,31,31,32,32,32,33,34,35,35,36,36,37,37,38,38,37,37,36,35,34,34,34,34,33],
    [39,39,39,39,39,39,39,39,39,39,38,38,38,38,37,38,38,38,39,39,40,40,41,41,42,43,44,43,42,42,41,41,40,40,40,40,39],
    [45,45,45,46,46,46,46,46,46,46,46,46,45,45,44,44,44,44,45,45,46,46,47,47,48,48,49,49,48,48,47,47,46,46,46,46,45],
    [52,52,52,52,53,53,53,53,54,54,54,53,52,52,51,51,51,51,51,51,51,52,53,53,54,54,54,54,54,54,53,53,53,52,52,52,52],
    [58,58,58,58,59,59,60,60,61,61,61,60,60,59,58,58,58,58,57,57,57,57,58,58,59,59,59,59,60,60,59,59,59,59,58,58,58],
    [64,64,64,64,65,65,66,67,68,67,67,67,67,66,65,65,64,64,63,63,62,62,63,63,64,64,64,64,65,65,65,65,65,65,64,64,64],
    [69,69,70,70,71,71,72,72,73,73,73,73,73,72,71,70,69,69,68,68,67,67,67,67,68,68,69,69,69,69,70,70,70,70,69,69,69],
    [73,74,75,75,75,76,76,76,77,77,78,78,77,76,76,75,74,73,72,72,71,71,71,71,71,71,72,73,73,73,74,74,74,74,73,73,73],
    [77,77,78,78,78,79,79,79,80,80,80,80,80,79,79,78,77,76,75,75,74,74,73,73,73,73,74,75,76,76,77,77,77,77,77,77,77],
    [80,80,80,80,79,79,79,79,80,80,80,80,80,80,79,79,78,78,77,77,76,75,74,74,74,74,75,76,77,77,78,79,79,79,80,80,80],
    [81,81,81,81,80,80,79,79,79,79,79,79,79,79,79,78,78,78,77,77,76,76,75,75,75,75,76,77,78,78,79,80,80,80,81,81,81],
    [82,82,82,82,81,81,80,79,78,78,77,77,77,77,77,77,76,76,76,76,75,75,75,75,75,75,76,76,77,78,79,81,81,81,82,82,82],
    [83,83,83,83,82,81,80,79,78,77,76,76,75,75,75,75,74,74,74,74,74,74,74,74,75,75,76,76,77,78,79,81,81,82,83,83,83]
]
CR=[0,0,0,0,0,0]
CD=[0,0,0,0,0,0]
CBR=[0,0,0,0,0,0]
PLN=0
for PLN in range(0,6,1):
    if(PLN==2): continue
    if(PLN==5):
        T_YEAR=(C+19.0)/10.0
        #L7_A:MLの長周期摂動の補正項L7の振幅
        L7_A=0.42-0.075*T_YEAR+0.015*T_YEAR-0.003*T_YEAR*T_YEAR*T_YEAR
        #L7:MLの長周期摂動の補正項
        L7=L7_A*math.sin((T_YEAR-0.62)*(360/0.925)*P)
        #PS7:PNLの長周期摂動の補正項
        PS7=0.02*math.sin((T_YEAR+0.1)*(360/0.925)*P)
        #PH7:ECの長周期摂動の補正項
        PH7=0.03*math.sin((T_YEAR+0.36)*(360/0.925)*P)
        #ETA,ZETA:摂動引数
        ETA=86.1+0.033459*(JD-1721057)
        ETA=COMPACT(ETA,360)
        ZETA=89.1+0.049630*(JD-1721057)
        ZETA=COMPACT(ZETA,360)
        ETA0=int(ETA/10.0)
        ZETA0=int(ZETA/10.0)
        ETA1=ETA0+1
        ZETA1=ETA0+1
        ZETA_DIFF=ZETA-float(ZETA0)*10.0
        ETA_DIFF=ETA-float(ETA0)*10.0
        #L8:MLの短周期摂動の補正項
        L8=TABLE_VALUE(JUP_L8[ZETA0][ETA0],JUP_L8[ZETA1][ETA0],JUP_L8[ZETA0][ETA1],JUP_L8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/100.0
        PS8=TABLE_VALUE(JUP_PS8[ZETA0][ETA0],JUP_PS8[ZETA1][ETA0],JUP_PS8[ZETA0][ETA1],JUP_PS8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/100.0
        PH8=TABLE_VALUE(JUP_PH8[ZETA0][ETA0],JUP_PH8[ZETA1][ETA0],JUP_PH8[ZETA0][ETA1],JUP_PH8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/100.0
        PH=2.58+0.1*T_YEAR
        L7=DIGIT2(L7)
        L8=DIGIT2(L8)
        PS7=DIGIT2(PS7)
        PS8=DIGIT2(PS8)
        PH7=DIGIT2(PH7)
        PH8=DIGIT2(PH8)

    if(PLN==6):
        T_YEAR=(C+19.0)/10.0
        L7_A=0.88-0.0633*T_YEAR+0.03*T_YEAR*T_YEAR-0.00006*T_YEAR*T_YEAR*T_YEAR
        L7=-0.5+L7_A*math.sin((T_YEAR-0.145)*(360/0.95)*P)
        PS7=-0.50+(0.10-0.005*T_YEAR)*math.sin((T_YEAR-0.54)*(360/0.95)*P)
        PH7=-0.50+(0.10-0.005*T_YEAR)*math.sin((T_YEAR-0.32)*(360/0.95)*P)
        AX7=-0.050+(0.004-0.0005*T_YEAR)*math.sin((T_YEAR-0.35)*(260/0.95)*P)
        ETA=86.1+0.033459*(JD-1721057)
        ETA=COMPACT(ETA,360)
        ZETA=89.1+0.049630*(JD-1721057)
        ZETA=COMPACT(ZETA,360)
        ETA0=int(ETA/10.0)
        ZETA0=int(ZETA/10.0)
        ETA1=ETA0+1
        ZETA1=ETA0+1
        ZETA_DIFF=ZETA-float(ZETA0)*10.0
        ETA_DIFF=ETA-float(ETA0)*10.0
        L8=TABLE_VALUE(SAT_L8[ZETA0][ETA0],SAT_L8[ZETA1][ETA0],SAT_L8[ZETA0][ETA1],SAT_L8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/100.0
        PS8=TABLE_VALUE(SAT_PS8[ZETA0][ETA0],SAT_PS8[ZETA1][ETA0],SAT_PS8[ZETA0][ETA1],SAT_PS8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/100.0
        PH8=TABLE_VALUE(SAT_PH8[ZETA0][ETA0],SAT_PH8[ZETA1][ETA0],SAT_PH8[ZETA0][ETA1],SAT_PH8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/100.0
        AX8=TABLE_VALUE(SAT_AX8[ZETA0][ETA0],SAT_AX8[ZETA1][ETA0],SAT_AX8[ZETA0][ETA1],SAT_AX8[ZETA1][ETA1],ZETA_DIFF,ETA_DIFF)/1000.0
        PH=3.56-0.175*T_YEAR-0.005*T_YEAR*T_YEAR

        L7=DIGIT2(L7)
        L8=DIGIT2(L8)
        PS7=DIGIT2(PS7)
        PS8=DIGIT2(PS8)
        PH7=DIGIT2(PH7)
        PH8=DIGIT2(PH8)
        AX7=DIGIT3(AX7)
        AX8-DIGIT3(AX8)
        
    MLS=ML[PLN][0]+ML[PLN][1]*C+ML[PLN][2]*C*C+ML[PLN][3]*C*C*C
    MLS=COMPACT(MLS,360)
    if(PLN==5 or PLN==6):
        MLS=MLS+L7+L8
    PNLS=PNL[PLN][0]+PNL[PLN][1]*C+PNL[PLN][2]*C*C+PNL[PLN][3]*C*C*C
    PNLS=COMPACT(PNLS,360)
    if(PLN==5 or PLN==6):
        PNLS=PNLS+(PS7+PS8)/math.sin(PH*P)
    ECS=EC[PLN][0]+EC[PLN][1]*C+EC[PLN][2]*C*C+EC[PLN][3]*C*C*C

    if(PLN==5 or PLN==6):
        ECS=math.sin((PH+PH7+PH8)*P)

    AXS=AX[PLN][0]
    if(PLN==6):
        AXS=AXS+AX7+AX8
    OMGS=OMG[PLN][0]+OMG[PLN][1]*C+OMG[PLN][2]*C*C+OMG[PLN][3]*C*C
    OMGS=COMPACT(OMGS,360)

    INCS=INC[PLN][0]+INC[PLN][1]*C+INC[PLN][2]*C*C+INC[PLN][3]*C*C*C
    MA=MLS-PNLS
    if(MA<0):  
        MA+=360
    MPG=(2*ECS-ECS*ECS*ECS/4.0)*math.sin(MA*P)+5.0/4.0*ECS*ECS*math.sin(2*MA*P)+13.0/12.0*ECS*ECS*ECS*math.sin(3*MA*P)
    MPG=MPG/P

    TA=MA+MPG
    UU=TA+PNLS-OMGS
    UU=TA+PNLS-OMGS
    if(UU>360):
        UU-=360
    if(UU<0):
        UU+=360
    
    CC=math.atan(math.cos(INCS*P)*math.tan(UU*P))/P
    if(UU>90.0 and UU<270.0):
        CC+=180
    if(UU>=270.0):
        CC+=360
    LL=CC+OMGS
    if(LL>360):
        LL-=360
    TB=math.atan(math.tan(INCS*P)*math.sin(CC*P))/P
    RR=AXS*(1-ECS*ECS)/(1+ECS*math.cos(TA*P))
    XX=RR*(math.cos(UU*P)*math.cos(OMGS*P)-math.sin(UU*P)*math.sin(OMGS*P)*math.cos(INCS*P))
    YY=RR*(math.cos(UU*P)*math.sin(OMGS*P)+math.sin(UU*P)*math.cos(OMGS*P)*math.cos(INCS*P))
    ZZ=RR*math.sin(UU*P)*math.sin(INCS*P)

    EX=SX+XX
    EY=SY+YY
    EZ=SZ+ZZ
    DD=math.sqrt(EX*EX+EY*EY+EZ*EZ)
    LAM=math.atan2(EY,EX)/P
    if(LAM<0):
        LAM=LAM+360
    BET=math.asin(EZ/DD)/P

    ELO=LAM-SL
    HL=LL-SL
    if(HL<0):
        HL+=360
    TT=math.sqrt(RR*RR+SRR*SRR+2*RR*SRR*math.cos(HL*P))
    II=math.acos((RR*RR+TT*TT-SRR*SRR)/(2*RR*TT))/P
    BR=0.0
    if(PLN==1):
        BR=1.16+5.0*math.log10(RR*TT)+0.02823*math.fabs(II-50.0)+0.0001023*(II-50)*(II-50)
        SD=3.36/3600.0/DD
    if(PLN==2):
        BR=-4.00+5.0*math.log10(RR*TT)+0.01322*II+0.0000004247*II*II
        SD=8.34/3600.0/DD
    if(PLN==4):
        BR=-1.30+5.0*math.log10(RR*TT)+0.01486*II
        SD=4.64/3600.0/DD
    if(PLN==5):
        BR=-8.93+5.0*math.log10(RR*TT)
        SD=98.44/3600.0/DD
    if(PLN==6):
        BR=-8.68+5.0*math.log10(RR*TT)-1.1*math.fabs(math.sin(LL+38.0-T_YEAR*1000))
        SD=82.73/3600.0/DD
    OBLS=OBL(JD)
    RA=math.atan2((math.cos(OBLS*P)*math.cos(BET*P)*math.sin(LAM*P)-math.sin(OBLS*P)*math.sin(BET*P)),math.cos(BET*P)*math.cos(LAM*P))/P
    if(RA<0):
        RA+=360.0
    DEC=math.asin(math.cos(OBLS*P)*math.sin(BET*P)+math.sin(OBLS*P)*math.cos(BET*P)*math.sin(LAM*P))/P
    DEC
    AZ_EL(JD,RA,DEC,LAT,LON)
    CR[PLN]=RA
    CD[PLN]=DEC
    CBR[PLN]=BR
CBR[2]=-90
plt.xlim(0,360)
plt.ylim(-24,24)
plt.scatter(CR,CD,marker='*',c=CBR,cmap='plasma')
plt.show()


